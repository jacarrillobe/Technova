<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel de Administraci√≥n - TechNova</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f4f6f9;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .navbar {
      background-color: #14213d;
    }
    .navbar-brand {
      font-weight: bold;
      color: #fff !important;
    }
    .navbar-nav .nav-link {
      color: #fff !important;
    }
    .card {
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .btn-add {
      background-color: #219ebc;
      color: #fff;
      border-radius: 8px;
    }
    .btn-add:hover {
      background-color: #1d7fa0;
    }
    .badge-activo {
      background-color: #adb5bd;
    }
    .badge-promocion {
      background-color: #52b788;
    }
    table td, table th {
      vertical-align: middle;
    }
    #usuarioActivo {
      font-size: 0.9rem;
      color: #495057;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand d-flex align-items-center" href="index.html">
      <img src="images/logo-technova.png" alt="TechNova Solutions" 
           style="height:150px; width:auto; margin-right:10px;">
      <a class="navbar-brand" href="index.html">TECH<span style="color:#4cc9f0;">NOVA</span></a>
    </a>

    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="index.html">Inicio</a></li>
        <li class="nav-item"><a class="nav-link" href="servicios.html">Servicios</a></li>
        <li class="nav-item"><a class="nav-link" href="login.html">Login</a></li>
      </ul>
    </div>
  </div>
</nav>

  <!-- Contenido -->
  <div class="container my-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="fw-bold">Gesti√≥n de Servicios</h2>
      <p id="usuarioActivo" class="mb-0"></p>
    </div>
    <div class="d-flex justify-content-end mb-4">
      <button id="btnAgregar" class="btn btn-add" data-bs-toggle="modal" data-bs-target="#modalAgregar">
        ‚ûï Agregar nuevo servicio
      </button>
    </div>

    <div class="card p-3">
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>ID</th>
              <th>Nombre</th>
              <th>Precio</th>
              <th>Propietario</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="tablaServicios"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Modal para agregar servicio -->
  <div class="modal fade" id="modalAgregar" tabindex="-1" aria-labelledby="modalAgregarLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="modalAgregarLabel">Agregar Nuevo Servicio</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <form id="formAgregar">
            <div class="mb-3">
              <label for="nombreServicio" class="form-label">Nombre del servicio</label>
              <input type="text" class="form-control" id="nombreServicio" required>
            </div>
            <div class="mb-3">
              <label for="precioServicio" class="form-label">Precio (COP)</label>
              <input type="number" class="form-control" id="precioServicio" required>
            </div>
            <div class="mb-3">
              <label for="estadoServicio" class="form-label">Estado</label>
              <select id="estadoServicio" class="form-select" required>
                <option value="">Seleccione...</option>
                <option value="Activo">Activo</option>
                <option value="Promoci√≥n">Promoci√≥n</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="descripcionServicio" class="form-label">Descripci√≥n</label>
              <textarea id="descripcionServicio" class="form-control" rows="3" required></textarea>
            </div>
            <div class="text-end">
              <button type="submit" class="btn btn-success">Guardar servicio</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
    <footer class="text-center py-4" style="background:#14213d; color:#fff;">
  <img src="images/logo-technova.png" alt="TechNova Solutions" 
       style="height:50px; width:auto; margin-bottom:10px;">
  <p class="mb-0">¬© 2025 TechNova Solutions</p>
  <p class="mb-0">contacto@technova.com</p>
</footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="data.js"></script>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const usuario = localStorage.getItem("usuarioActivo");
    const rol = localStorage.getItem("rolActivo");
    const tabla = document.getElementById("tablaServicios");

    // Validar sesi√≥n
    if (!usuario) {
      alert("Debes iniciar sesi√≥n para acceder al panel.");
      window.location.href = "login.html";
      return;
    }

    // Mostrar usuario logueado
    document.getElementById("usuarioActivo").innerText =
      "Conectado como: " + usuario + " (" + rol + ")";

    // Filtrar servicios seg√∫n el rol
    let serviciosFiltrados = [];
    if (rol === "Administrador" || rol === "T√©cnico") {
      serviciosFiltrados = servicios;
    } else {
      serviciosFiltrados = servicios.filter(s => s.propietario === usuario);
    }

    // Renderizar tabla
    function renderTabla() {
      tabla.innerHTML = "";
      serviciosFiltrados.forEach(servicio => {
        const fila = document.createElement("tr");
        fila.innerHTML = `
          <td>${servicio.id}</td>
          <td>${servicio.nombre}</td>
          <td>$${servicio.precio.toLocaleString()} COP</td>
          <td>${servicio.propietario}</td>
          <td>
            <span class="badge ${servicio.estado === 'Activo' ? 'badge-activo' : 'badge-promocion'}">
              ${servicio.estado}
            </span>
          </td>
          <td>
            <a href="#" class="text-primary me-2">‚úèÔ∏è</a>
            <a href="#" class="text-danger">üóëÔ∏è</a>
          </td>
        `;
        tabla.appendChild(fila);
      });
    }

    renderTabla();

    // Agregar nuevo servicio desde el formulario
    document.getElementById("formAgregar").addEventListener("submit", function(e) {
      e.preventDefault();

      const nombre = document.getElementById("nombreServicio").value;
      const precio = document.getElementById("precioServicio").value;
      const estado = document.getElementById("estadoServicio").value;
      const descripcion = document.getElementById("descripcionServicio").value;

      const nuevoServicio = {
        id: servicios.length + 1,
        nombre,
        precio: parseInt(precio),
        cantidad: 1,
        descripcion,
        estado,
        propietario: usuario
      };

      servicios.push(nuevoServicio);

      // Actualizar la vista
      if (rol !== "Administrador" && rol !== "T√©cnico") {
        serviciosFiltrados = servicios.filter(s => s.propietario === usuario);
      } else {
        serviciosFiltrados = servicios;
      }

      renderTabla();
      alert("Servicio agregado correctamente.");
      document.getElementById("formAgregar").reset();

      // Cerrar modal
      const modal = bootstrap.Modal.getInstance(document.getElementById("modalAgregar"));
      modal.hide();
    });

    // Logout
    document.getElementById("logoutBtn").addEventListener("click", (e) => {
      e.preventDefault();
      localStorage.removeItem("usuarioActivo");
      localStorage.removeItem("rolActivo");
      alert("Sesi√≥n cerrada correctamente.");
      window.location.href = "index.html";
    });
  });
  </script>
</body>
</html>
